<template>
    <aside class="menu">
        <p class="menu-label">Datacenter Builds</p>
        <ul class="menu-list">
            <li>
                <router-link :to="{ name: 'status', params: { currentWorkspace: currentWorkspaceId }}" active-class="is-active">Status</router-link>
            </li>
            <li>
                <router-link :to="{ name: 'datacenter', params: { currentWorkspace: currentWorkspaceId }}" active-class="is-active">Browse</router-link>
            </li>
            <li>
                <router-link :to="{ name: 'workspace', params: { currentWorkspace: currentWorkspaceId }}" active-class="is-active">Devices</router-link>
            </li>
        </ul>
        <p class="menu-label">Conch</p>
        <ul class="menu-list">
            <li>
                <router-link :to="{ name: 'user' }" active-class="is-active">Profile</router-link>
            </li>
            <li>
                <a @click="signOut">Log out</a>
            </li>
        </ul>
        <br />
        <div class="box conch-versions">
            <p class="heading">Conch Versions</p>
            <div class="tags-container">
                <div class="tags has-addons">
                    <div class="tag is-primary">conch-api</div>
                    <div class="tag is-dark">{{ conchVersion }}</div>
                </div>
                <div class="tags has-addons">
                    <div class="tag is-primary">conch-ui</div>
                    <div class="tag is-dark">{{ conchUIVersion }}</div>
                </div>
            </div>
        </div>
    </aside>
</template>

<script>
import * as ConchApiVersion from '../../api/conchApiVersion.js';
import { logout } from '../../api/authentication.js';
import { mapState } from 'vuex';

export default {
    data() {
        return {
            conchVersion: '',
            conchUIVersion: '',
        };
    },
    computed: {
        ...mapState([
            'currentWorkspace',
        ]),
        currentWorkspaceId() {
            return this.currentWorkspace.id;
        },
    },
    methods: {
        signOut() {
            logout()
                .then(() => {
                    this.$router.push({ path: '/' });
                });
        },
    },
    created() {
        this.conchUIVersion = CONCH.GLOBALS.conchUIVersion;

        ConchApiVersion.get()
            .then(response => {
                this.conchVersion = response.data.version;
            });
    }
};
</script>
